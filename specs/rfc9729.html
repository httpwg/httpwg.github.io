<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>RFC 9729 - The Concealed HTTP Authentication Scheme</title><script>
function getMeta(rfcno, container) {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "https://www.rfc-editor.org/rfc/rfc" + rfcno + ".json", true);
  xhr.onload = function (e) {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        var data = JSON.parse(xhr.response);
        
        var cont = document.getElementById(container);
        // empty the container
        while (cont.firstChild) {
          cont.removeChild(myNode.firstChild);
        }

        var c = data.status;
        if (c) {
          var bld = newElementWithText("b", c);
          cont.appendChild(bld);
        } else {
          cont.appendChild(newElementWithText("i", "(document status unknown)"));
        }

        c = data.updated_by;
        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
          cont.appendChild(newElement("br"));
          cont.appendChild(newText("Updated by: "));
          appendRfcLinks(cont, c);
        }

        c = data.obsoleted_by;
        if (c && c.length > 0 && c[0] !== null && c[0].length > 0) {
          cont.appendChild(newElement("br"));
          cont.appendChild(newText("Obsoleted by: "));
          appendRfcLinks(cont, c);
        }

        c = data.errata_url;
        if (c) {
          cont.appendChild(newElement("br"));
          var link = newElementWithText("a", "errata");
          link.setAttribute("href", c);
          var errata = newElementWithText("i", "This document has ");
          errata.appendChild(link);
          errata.appendChild(newText("."));
          cont.appendChild(errata);
        }

        cont.style.display = "block";
      } else {
        console.error(xhr.statusText);
      }
    }
  };
  xhr.onerror = function (e) {
    console.error(xhr.status + " " + xhr.statusText);
  };
  xhr.send(null);
}
function appendRfcLinks(parent, updates) {
  var template = "https://www.rfc-editor.org/rfc/rfc{rfc}.html";
  for (var i = 0; i < updates.length; i++) {
    var rfc = updates[i].trim().toLowerCase();
    if (rfc.substring(0, 3) == "rfc") {
      var no = parseInt(rfc.substring(3), 10);
      
      var link = newElement("a");
      link.setAttribute("href", template.replace("{rfc}", no));
      link.appendChild(newText(no));
      parent.appendChild(link);
    } else {
      parent.appendChild(newText(rfc));
    }
    if (i != updates.length - 1) {
      parent.appendChild(newText(", "));
    }
  }
}

// DOM helpers
function newElement(name) {
  return document.createElement(name);
}
function newElementWithText(name, txt) {
  var e = document.createElement(name);
  e.appendChild(newText(txt));
  return e;
}
function newText(text) {
  return document.createTextNode(text);
}
</script><script>
function anchorRewrite() {
  map = { };
  if (window.location.hash.length >= 1) {
    var fragid = window.location.hash.substr(1);
    if (fragid) {
      if (! document.getElementById(fragid)) {
        var prefix = "rfc.";
        var mapped = map[fragid];
        if (mapped) {
          window.location.hash = mapped;
        } else if (fragid.indexOf("section-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(8).replace("-",".p.");
        } else if (fragid.indexOf("appendix-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(9).replace("-",".p.");
        } else if (fragid.indexOf("s-") == 0) {
          var postfix = fragid.substring(2);
          if (postfix.startsWith("abstract")) {
            window.location.hash = prefix + postfix;
          } else if (postfix.startsWith("note-")) {
            window.location.hash = prefix + "note." + postfix.substring(5).replace("-",".p.");
          } else {
            window.location.hash = prefix + "section." + postfix.replace("-",".p.");
          }
        } else if (fragid.indexOf("p-") == 0) {
          var r = fragid.substring(2);
          var p = r.indexOf("-");
          if (p >= 0) {
            window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
          }
        }
      }
    }  
  }
}
window.addEventListener('hashchange', anchorRewrite);
window.addEventListener('DOMContentLoaded', anchorRewrite);
</script><meta name="viewport" content="width=device-width, initial-scale=1"><meta property="og:type" content="article"><meta property="og:title" content="RFC9729"><meta property="og:description" content="The Concealed HTTP Authentication Scheme"><meta property="og:url" content="https://httpwg.org/specs/rfc9729.html"><meta property="og:site_name" content="IETF HTTP Working Group Specifications"><meta property="og:image" content="https://httpwg.org/assets/favicon/apple-icon-180x180.png"><link rel="stylesheet" type="text/css" href="/assets/node_modules/bootstrap/dist/css/bootstrap.min.css"><style type="text/css">
      body {
        padding-top: 80px;
        padding-bottom: 80px;
        position: relative;
      }
      .table.header th, .table.header td {
        border-top: none;
        padding: 0;
      }
      #sidebar {
        margin-top: -10px;
        height: 90%;
        overflow-y: auto;
        font-size: 90%;
      }
      #rfc\.meta {
        width: 40%;
        float: right
      }
      .toc ul {
        list-style: none;
      }
      .filename {
        color: rgb(119, 119, 119);
        font-size: 23px;
        font-weight: normal;
        height: auto;
        line-height: 23px;
      }
      dl {
        margin-left: 1em;
      }
      dl.dl-horizontal: {
        margin-left: 0;
      }
      dl > dt {
        float: left;
        margin-right: 1em;
      }
      dl.nohang > dt {
        float: none;
      }
      dl > dd {
        margin-bottom: .5em;
      }
      dl.compact > dd {
        margin-bottom: 0em;
      }
      dl > dd > dl {
        margin-top: 0.5em;
        margin-bottom: 0em;
      }
      ul.empty {
        list-style-type: none;
      }
      ul.empty li {
        margin-top: .5em;
      }
      td.reference {
        padding-right: 1em;
        vertical-align: top;
      }
      .feedback {
        position: fixed;
        bottom: 5px;
        right: 5px;
      }
      .fbbutton {
        margin-left: 5px;
      }
      h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
        color: rgb(51, 51, 51);
      }
      span.tt {
        font: 11pt consolas, monospace;
        font-size-adjust: none;
      }
    </style><link rel="stylesheet" type="text/css" href="/assets/site.css"><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="License" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 The Concealed HTTP Authentication Scheme" href="#rfc.section.2"><link rel="Chapter" title="3 Client Handling" href="#rfc.section.3"><link rel="Chapter" title="4 Authentication Parameters" href="#rfc.section.4"><link rel="Chapter" title="5 Example" href="#rfc.section.5"><link rel="Chapter" title="6 Server Handling" href="#rfc.section.6"><link rel="Chapter" title="7 Requirements on TLS Usage" href="#rfc.section.7"><link rel="Chapter" title="8 Security Considerations" href="#rfc.section.8"><link rel="Chapter" title="9 IANA Considerations" href="#rfc.section.9"><link rel="Chapter" title="10 References" href="#rfc.section.10"><link rel="Appendix" title="Acknowledgments" href="#rfc.section.unnumbered-4"><link href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-unprompted-auth-12" rel="prev"><link href="https://dx.doi.org/10.17487/rfc9729" rel="alternate"><link href="urn:issn:2070-1721" rel="alternate"><link rel="Alternate" title="Plain Text Version" href="http://www.ietf.org/rfc/rfc9729.txt"><link rel="Help" title="RFC-Editor's Status Page" href="https://www.rfc-editor.org/info/rfc9729"><meta name="viewport" content="initial-scale=1"><meta name="generator" content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/"><meta name="keywords" content="secure, tunnels, masque, http-ng"><link rel="schema.dcterms" href="http://purl.org/dc/terms/"><meta name="dcterms.creator" content="Schinazi, D."><meta name="dcterms.creator" content="Oliver, D."><meta name="dcterms.creator" content="Hoyland, J."><meta name="dcterms.identifier" content="urn:ietf:rfc:9729"><meta name="dcterms.issued" content="2025-02"><meta name="dcterms.abstract" content="Most HTTP authentication schemes are probeable in the sense that it is possible for an unauthenticated client to probe whether an origin serves resources that require authentication. It is possible for an origin to hide the fact that it requires authentication by not generating Unauthorized status codes; however, that only works with non-cryptographic authentication schemes: cryptographic signatures require a fresh nonce to be signed. Prior to this document, there was no existing way for the origin to share such a nonce without exposing the fact that it serves resources that require authentication. This document defines a new non-probeable cryptographic authentication scheme."><meta name="dcterms.isPartOf" content="urn:issn:2070-1721"><meta name="description" content="Most HTTP authentication schemes are probeable in the sense that it is possible for an unauthenticated client to probe whether an origin serves resources that require authentication. It is possible for an origin to hide the fact that it requires authentication by not generating Unauthorized status codes; however, that only works with non-cryptographic authentication schemes: cryptographic signatures require a fresh nonce to be signed. Prior to this document, there was no existing way for the origin to share such a nonce without exposing the fact that it serves resources that require authentication. This document defines a new non-probeable cryptographic authentication scheme."></head><body onload="getMeta(9729,&#34;rfc.meta&#34;);"><nav class="navbar navbar-dark bg-dark d-print-none navbar-expand-lg fixed-top ps-3 pe-3" role="navigation">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse" aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <a class="navbar-brand" href="https://httpwg.org/"><img src="https://httpwg.org/assets/http.svg" height="23"></a>
  </div>
  
  <div class="collapse navbar-collapse" id="navbar-collapse">
      
    <div class="navbar-nav me-auto">

      <a class="nav-item ms-1 text-white" href="https://httpwg.org/specs/">ðŸ“„ Documentation</a>

      <div class="dropdown ms-4">
        <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Work in Progress</a>
          <ul class="dropdown-menu"><li class="dropdown-item"><a href="https://httpwg.org/http-extensions/">HTTP Extensions</a></li><li class="dropdown-item"><a href="https://github.com/httpwg/admin/issues?q=is%3Aissue+is%3Aopen+label%3Aadoption">Future Work</a></li></ul>
      </div>

      <div class="dropdown ms-4">
        <a href="#" class="nav-item dropdown-toggle text-white" data-bs-toggle="dropdown">Participate</a>
          <ul class="dropdown-menu"><li class="dropdown-item"><a href="https://httpwg.org/about/">About the HTTP Working Group</a></li><li class="divider"></li><li class="dropdown-item"><a href="https://httpwg.org/CONTRIBUTING.html">Contribution Policy</a></li><li class="dropdown-item"><a href="http://datatracker.ietf.org/wg/httpbis/charter/">WG Charter</a></li><li class="dropdown-item"><a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">Group Mailing List ðŸ“¨</a></li><li class="dropdown-item"><a href="https://httpwg.org/wg-materials/">Meeting Materials</a></li><li class="dropdown-item"><a href="https://httpwg.org/admin/editors/">Document Editor Resources</a></li></ul>
      </div>
    </div>
            
  </div>
</nav><div class="container" id="top"><div class="row"><div class="col-lg-4 order-last d-none d-lg-block" id="sidebar" role="navigation"><div class="navbar"><div class="navbar-brand"><a href="#top"><strong>RFC </strong>9729</a></div><br clear="all"><div class=""><div class="toc "><ul><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#conventions">Conventions and Definitions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#the-concealed-http-authentication-scheme">The Concealed HTTP Authentication Scheme</a></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#client">Client Handling</a><ul><li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a href="#context">Key Exporter Context</a><ul><li><a href="#rfc.section.3.1.1">3.1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#public-key-encoding">Public Key Encoding</a></li></ul></li><li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a href="#output">Key Exporter Output</a></li><li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a href="#computation">Signature Computation</a></li></ul></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#auth-params">Authentication Parameters</a><ul><li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-k">The k Parameter</a></li><li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-a">The a Parameter</a></li><li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-p">The p Parameter</a></li><li><a href="#rfc.section.4.4">4.4.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-s">The s Parameter</a></li><li><a href="#rfc.section.4.5">4.5.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-v">The v Parameter</a></li></ul></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#example">Example</a></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#server-handling">Server Handling</a><ul><li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a href="#frontend-handling">Frontend Handling</a></li><li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a href="#communication-between-frontend-and-backend">Communication Between Frontend and Backend</a></li><li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a href="#backend">Backend Handling</a></li><li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a href="#non-probeable-server-handling">Non-Probeable Server Handling</a></li></ul></li><li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#requirements-on-tls-usage">Requirements on TLS Usage</a></li><li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#security">Security Considerations</a></li><li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA Considerations</a><ul><li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-schemes">HTTP Authentication Schemes Registry</a></li><li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-exporter-label">TLS Keying Material Exporter Labels</a></li><li><a href="#rfc.section.9.3">9.3.</a>&nbsp;&nbsp;&nbsp;<a href="#http-field-name">HTTP Field Name</a></li></ul></li><li><a href="#rfc.section.10">10.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a><ul><li><a href="#rfc.section.10.1">10.1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.2">Normative References</a></li><li><a href="#rfc.section.10.2">10.2.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.3">Informative References</a></li></ul></li><li><a href="#acknowledgments">Acknowledgments</a></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></div></div></div></div><div class="col-lg-8 order-first main" role="main"><header><table class="table table-condensed header" id="rfc.headerblock"><tbody><tr><td class="text-left">Internet Engineering Task Force (IETF)</td><td class="text-right">D. Schinazi</td></tr><tr><td class="text-left">Request for Comments: 9729</td><td class="text-right">Google LLC</td></tr><tr><td class="text-left">Category: Standards Track</td><td class="text-right">D. Oliver</td></tr><tr><td class="text-left">ISSN: 2070-1721</td><td class="text-right">Guardian Project</td></tr><tr><td class="text-left"></td><td class="text-right">J. Hoyland</td></tr><tr><td class="text-left"></td><td class="text-right">Cloudflare Inc.</td></tr><tr><td class="text-left"></td><td class="text-right">February 2025</td></tr></tbody></table><div id="rfc.title"><h1>The Concealed HTTP Authentication Scheme</h1></div></header><hr><h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2><div class="lead"><div id="rfc.abstract.p.1"><p>Most HTTP authentication schemes are probeable in the sense that it is possible for an unauthenticated client to probe whether an origin serves resources that require authentication. It is possible for an origin to hide the fact that it requires authentication by not generating Unauthorized status codes; however, that only works with non-cryptographic authentication schemes: cryptographic signatures require a fresh nonce to be signed. Prior to this document, there was no existing way for the origin to share such a nonce without exposing the fact that it serves resources that require authentication. This document defines a new non-probeable cryptographic authentication scheme.</p></div></div><aside id="rfc.meta" class="alert alert-info"></aside><section id="rfc.status"><h2><a href="#rfc.status">Status of This Memo</a></h2><div id="rfc.boilerplate.1.p.1"><p>This is an Internet Standards Track document.</p></div><div id="rfc.boilerplate.1.p.2"><p>This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in <a href="https://www.rfc-editor.org/rfc/rfc7841.html#section-2">Section 2 of RFC 7841</a>.</p></div><div id="rfc.boilerplate.1.p.3"><p>Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at <a href="https://www.rfc-editor.org/info/rfc9729">https://www.rfc-editor.org/info/rfc9729</a>.</p></div></section><section id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><div id="rfc.boilerplate.2.p.1"><p>Copyright (c) 2025 IETF Trust and the persons identified as the document authors. All rights reserved.</p></div><div id="rfc.boilerplate.2.p.2"><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Revised BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Revised BSD License.</p></div></section><div class="toc d-lg-none"><ul><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#conventions">Conventions and Definitions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#the-concealed-http-authentication-scheme">The Concealed HTTP Authentication Scheme</a></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#client">Client Handling</a><ul><li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a href="#context">Key Exporter Context</a><ul><li><a href="#rfc.section.3.1.1">3.1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#public-key-encoding">Public Key Encoding</a></li></ul></li><li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a href="#output">Key Exporter Output</a></li><li><a href="#rfc.section.3.3">3.3.</a>&nbsp;&nbsp;&nbsp;<a href="#computation">Signature Computation</a></li></ul></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#auth-params">Authentication Parameters</a><ul><li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-k">The k Parameter</a></li><li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-a">The a Parameter</a></li><li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-p">The p Parameter</a></li><li><a href="#rfc.section.4.4">4.4.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-s">The s Parameter</a></li><li><a href="#rfc.section.4.5">4.5.</a>&nbsp;&nbsp;&nbsp;<a href="#parameter-v">The v Parameter</a></li></ul></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#example">Example</a></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#server-handling">Server Handling</a><ul><li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a href="#frontend-handling">Frontend Handling</a></li><li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a href="#communication-between-frontend-and-backend">Communication Between Frontend and Backend</a></li><li><a href="#rfc.section.6.3">6.3.</a>&nbsp;&nbsp;&nbsp;<a href="#backend">Backend Handling</a></li><li><a href="#rfc.section.6.4">6.4.</a>&nbsp;&nbsp;&nbsp;<a href="#non-probeable-server-handling">Non-Probeable Server Handling</a></li></ul></li><li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#requirements-on-tls-usage">Requirements on TLS Usage</a></li><li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#security">Security Considerations</a></li><li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA Considerations</a><ul><li><a href="#rfc.section.9.1">9.1.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-schemes">HTTP Authentication Schemes Registry</a></li><li><a href="#rfc.section.9.2">9.2.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-exporter-label">TLS Keying Material Exporter Labels</a></li><li><a href="#rfc.section.9.3">9.3.</a>&nbsp;&nbsp;&nbsp;<a href="#http-field-name">HTTP Field Name</a></li></ul></li><li><a href="#rfc.section.10">10.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a><ul><li><a href="#rfc.section.10.1">10.1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.2">Normative References</a></li><li><a href="#rfc.section.10.2">10.2.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.3">Informative References</a></li></ul></li><li><a href="#acknowledgments">Acknowledgments</a></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></div><hr class="hidden-print"><section id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>HTTP authentication schemes (see <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-11">Section 11</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>) allow origins to restrict access for some resources to only authenticated requests. While these schemes commonly involve a challenge where the origin asks the client to provide authentication information, it is possible for clients to send such information unprompted. This is particularly useful in cases where an origin wants to offer a service or capability only to "those who know", while all others are given no indication the service or capability exists. Such designs rely on an externally defined mechanism by which keys are distributed. For example, a company might offer remote employee access to company services directly via its website using their employee credentials or offer access to limited special capabilities for specific employees while making discovering (or probing for) such capabilities difficult. As another example, members of less well-defined communities might use more ephemeral keys to acquire access to geography- or capability-specific resources, as issued by an entity whose user base is larger than the available resources can support (by having that entity metering the availability of keys temporally or geographically).</p></div><div id="rfc.section.1.p.2"><p>While digital-signature-based HTTP authentication schemes already exist (e.g., <a href="#RFC7486"><cite title="HTTP Origin-Bound Authentication (HOBA)">[HOBA]</cite></a>), they rely on the origin explicitly sending a fresh challenge to the client, to ensure that the signature input is fresh. That makes the origin probeable as it sends the challenge to unauthenticated clients. This document defines a new signature-based authentication scheme that is not probeable.</p></div><section id="conventions"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a href="#conventions">Conventions and Definitions</a></h3><div id="rfc.section.1.1.p.1"><p>The key words "<em class="bcp14">MUST</em>", "<em class="bcp14">MUST NOT</em>", "<em class="bcp14">REQUIRED</em>", "<em class="bcp14">SHALL</em>", "<em class="bcp14">SHALL NOT</em>", "<em class="bcp14">SHOULD</em>", "<em class="bcp14">SHOULD NOT</em>", "<em class="bcp14">RECOMMENDED</em>", "<em class="bcp14">NOT RECOMMENDED</em>", "<em class="bcp14">MAY</em>", and "<em class="bcp14">OPTIONAL</em>" in this document are to be interpreted as described in <span class="nobr">BCP 14</span> <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a> <a href="#RFC8174"><cite title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a> when, and only when, they appear in all capitals, as shown here.</p></div><div id="rfc.section.1.1.p.2"><p>This document uses the notation from <a href="https://www.rfc-editor.org/rfc/rfc9000.html#section-1.3">Section 1.3</a> of <a href="#RFC9000"><cite title="QUIC: A UDP-Based Multiplexed and Secure Transport">[QUIC]</cite></a>.</p></div><div id="rfc.section.1.1.p.3"><p>Various examples in this document contain long lines that may be folded, as described in <a href="#RFC8792"><cite title="Handling Long Lines in Content of Internet-Drafts and RFCs">[RFC8792]</cite></a>.</p></div></section></section><hr class="hidden-print"><section id="the-concealed-http-authentication-scheme"><h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#the-concealed-http-authentication-scheme">The Concealed HTTP Authentication Scheme</a></h2><div id="rfc.section.2.p.1"><p>This document defines the "Concealed" HTTP authentication scheme. It uses asymmetric cryptography. Clients possess a key ID and a public/private key pair, and origin servers maintain a mapping of authorized key IDs to associated public keys.</p></div><div id="rfc.section.2.p.2"><p>The client uses a TLS keying material exporter to generate data to be signed (see <a href="#client" title="Client Handling">Section 3</a>) then sends the signature using the Authorization (or Proxy-Authorization) header field (see <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-11">Section 11</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>). The signature and additional information are exchanged using authentication parameters (see <a href="#auth-params" title="Authentication Parameters">Section 4</a>). Once the server receives these, it can check whether the signature validates against an entry in its database of known keys. The server can then use the validation result to influence its response to the client, for example, by restricting access to certain resources.</p></div></section><hr class="hidden-print"><section id="client"><h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#client">Client Handling</a></h2><div id="rfc.section.3.p.1" class="avoidbreakafter"><p>When a client wishes to use the Concealed HTTP authentication scheme with a request, it <em class="bcp14">SHALL</em> compute the authentication proof using a TLS keying material exporter with the following parameters:</p></div><div id="rfc.section.3.p.2"><ul><li><div><p>The label is set to "EXPORTER-HTTP-Concealed-Authentication".</p></div> </li><li><div><p>The context is set to the structure described in <a href="#context" title="Key Exporter Context">Section 3.1</a>.</p></div> </li><li><div><p>The exporter output length is set to 48 bytes (see <a href="#output" title="Key Exporter Output">Section 3.2</a>).</p></div> </li></ul></div><div id="rfc.section.3.p.3"><p>Note that TLS 1.3 keying material exporters are defined in <a href="https://www.rfc-editor.org/rfc/rfc8446.html#section-7.5">Section 7.5</a> of <a href="#RFC8446"><cite title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>, while TLS 1.2 keying material exporters are defined in <a href="#RFC5705"><cite title="Keying Material Exporters for Transport Layer Security (TLS)">[KEY-EXPORT]</cite></a>.</p></div><section id="context"><h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a href="#context">Key Exporter Context</a></h3><div id="rfc.section.3.1.p.1" class="avoidbreakafter"><p>The TLS key exporter context is described in <a href="#fig-context" title="Key Exporter Context Format">Figure 1</a>, using the notation from <a href="https://www.rfc-editor.org/rfc/rfc9000.html#section-1.3">Section 1.3</a> of <a href="#RFC9000"><cite title="QUIC: A UDP-Based Multiplexed and Secure Transport">[QUIC]</cite></a>:</p></div><div id="fig-context"></div><div id="rfc.figure.1"><div><pre>
  Signature Algorithm (16),
  Key ID Length (i),
  Key ID (..),
  Public Key Length (i),
  Public Key (..),
  Scheme Length (i),
  Scheme (..),
  Host Length (i),
  Host (..),
  Port (16),
  Realm Length (i),
  Realm (..),
</pre></div></div><p class="figure">Figure 1: Key Exporter Context Format</p><div id="rfc.section.3.1.p.2" class="avoidbreakafter"><p>The key exporter context contains the following fields:</p></div><div id="rfc.section.3.1.p.3"><dl><dt>Signature Algorithm:</dt><dd style="margin-left: 1.5em"><div>The signature scheme sent in the <span class="tt">s</span> Parameter (see <a href="#parameter-s" title="The s Parameter">Section 4.4</a>).</div></dd><dt>Key ID:</dt><dd style="margin-left: 1.5em"><div>The key ID sent in the <span class="tt">k</span> Parameter (see <a href="#parameter-k" title="The k Parameter">Section 4.1</a>).</div></dd><dt>Public Key:</dt><dd style="margin-left: 1.5em"><div>The public key used by the server to validate the signature provided by the client. Its encoding is described in <a href="#public-key-encoding" title="Public Key Encoding">Section 3.1.1</a>.</div></dd><dt>Scheme:</dt><dd style="margin-left: 1.5em"><div>The scheme for this request, encoded using the format of the scheme portion of a URI as defined in <a href="https://www.rfc-editor.org/rfc/rfc3986.html#section-3.1">Section 3.1</a> of <a href="#RFC3986"><cite title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>.</div></dd><dt>Host:</dt><dd style="margin-left: 1.5em"><div>The host for this request, encoded using the format of the host portion of a URI as defined in <a href="https://www.rfc-editor.org/rfc/rfc3986.html#section-3.2.2">Section 3.2.2</a> of <a href="#RFC3986"><cite title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>.</div></dd><dt>Port:</dt><dd style="margin-left: 1.5em"><div>The port for this request, encoded in network byte order. Note that the port is either included in the URI or is the default port for the scheme in use; see <a href="https://www.rfc-editor.org/rfc/rfc3986.html#section-3.2.3">Section 3.2.3</a> of <a href="#RFC3986"><cite title="Uniform Resource Identifier (URI): Generic Syntax">[URI]</cite></a>.</div></dd><dt>Realm:</dt><dd style="margin-left: 1.5em"><div>The realm of authentication that is sent in the realm authentication parameter (see <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-11.5">Section 11.5</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>). If the realm authentication parameter is not present, this <em class="bcp14">SHALL</em> be empty. This document does not define a means for the origin to communicate a realm to the client. If a client is not configured to use a specific realm, it <em class="bcp14">SHALL</em> use an empty realm and <em class="bcp14">SHALL NOT</em> send the realm authentication parameter.</div></dd></dl></div><div id="rfc.section.3.1.p.4"><p>The Signature Algorithm and Port fields are encoded as unsigned 16-bit integers in network byte order. The Key ID, Public Key, Scheme, Host, and Realm fields are length-prefixed strings; they are preceded by a Length field that represents their length in bytes. These length fields are encoded using the variable-length integer encoding from <a href="https://www.rfc-editor.org/rfc/rfc9000.html#section-16">Section 16</a> of <a href="#RFC9000"><cite title="QUIC: A UDP-Based Multiplexed and Secure Transport">[QUIC]</cite></a> and <em class="bcp14">MUST</em> be encoded in the minimum number of bytes necessary.</p></div><section id="public-key-encoding"><h4 id="rfc.section.3.1.1"><a href="#rfc.section.3.1.1">3.1.1.</a>&nbsp;<a href="#public-key-encoding">Public Key Encoding</a></h4><div id="rfc.section.3.1.1.p.1" class="avoidbreakafter"><p>Both the "Public Key" field of the TLS key exporter context (see above) and the <span class="tt">a</span> Parameter (see <a href="#parameter-a" title="The a Parameter">Section 4.2</a>) carry the same public key. The encoding of the public key is determined by the signature algorithm in use as follows:</p></div><div id="rfc.section.3.1.1.p.2"><dl><dt>RSASSA-PSS algorithms:</dt><dd style="margin-left: 1.5em"><div>The public key is an RSAPublicKey structure <a href="#RFC8017"><cite title="PKCS #1: RSA Cryptography Specifications Version 2.2">[PKCS1]</cite></a> encoded in DER <a href="#X.690"><cite title="Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)">[X.690]</cite></a>. BER encodings that are not DER <em class="bcp14">MUST</em> be rejected.</div></dd><dt>ECDSA algorithms:</dt><dd style="margin-left: 1.5em"><div>The public key is an UncompressedPointRepresentation structure defined in <a href="https://www.rfc-editor.org/rfc/rfc8446.html#section-4.2.8.2">Section 4.2.8.2</a> of <a href="#RFC8446"><cite title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>, using the curve specified by the SignatureScheme.</div></dd><dt>EdDSA algorithms:</dt><dd style="margin-left: 1.5em"><div>The public key is the byte string encoding defined in <a href="#RFC8032"><cite title="Edwards-Curve Digital Signature Algorithm (EdDSA)">[EdDSA]</cite></a>.</div></dd></dl></div><div id="rfc.section.3.1.1.p.3"><p>This document does not define the public key encodings for other algorithms. In order for a SignatureScheme to be usable with the Concealed HTTP authentication scheme, its public key encoding needs to be defined in a corresponding document.</p></div></section></section><section id="output"><h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a href="#output">Key Exporter Output</a></h3><div id="rfc.section.3.2.p.1" class="avoidbreakafter"><p>The key exporter output is 48 bytes long. Of those, the first 32 bytes are part of the input to the signature and the next 16 bytes are sent alongside the signature. This allows the recipient to confirm that the exporter produces the right values. This is described in <a href="#fig-output" title="Key Exporter Output Format">Figure 2</a>, using the notation from <a href="https://www.rfc-editor.org/rfc/rfc9000.html#section-1.3">Section 1.3</a> of <a href="#RFC9000"><cite title="QUIC: A UDP-Based Multiplexed and Secure Transport">[QUIC]</cite></a>:</p></div><div id="fig-output"></div><div id="rfc.figure.2"><div><pre>
  Signature Input (256),
  Verification (128),
</pre></div></div><p class="figure">Figure 2: Key Exporter Output Format</p><div id="rfc.section.3.2.p.2" class="avoidbreakafter"><p>The key exporter output contains the following fields:</p></div><div id="rfc.section.3.2.p.3"><dl><dt>Signature Input:</dt><dd style="margin-left: 1.5em"><div>This is part of the data signed using the client's chosen asymmetric private key (see <a href="#computation" title="Signature Computation">Section 3.3</a>).</div></dd><dt>Verification:</dt><dd style="margin-left: 1.5em"><div>The verification is transmitted to the server using the <span class="tt">v</span> Parameter (see <a href="#parameter-v" title="The v Parameter">Section 4.5</a>).</div></dd></dl></div></section><section id="computation"><h3 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a>&nbsp;<a href="#computation">Signature Computation</a></h3><div id="rfc.section.3.3.p.1" class="avoidbreakafter"><p>Once the Signature Input has been extracted from the key exporter output (see <a href="#output" title="Key Exporter Output">Section 3.2</a>), it is prefixed with static data before being signed. The signature is computed over the concatenation of:</p></div><div id="rfc.section.3.3.p.2"><ul><li><div><p>A string that consists of octet 32 (0x20) repeated 64 times</p></div> </li><li><div><p>The context string "HTTP Concealed Authentication"</p></div> </li><li><div><p>A single 0 byte that serves as a separator</p></div> </li><li><div><p>The Signature Input extracted from the key exporter output (see <a href="#output" title="Key Exporter Output">Section 3.2</a>)</p></div> </li></ul></div><div id="rfc.section.3.3.p.3" class="avoidbreakafter"><p>For example, if the Signature Input has all its 32 bytes set to 01, the content covered by the signature (in hexadecimal format) would be:</p></div><div id="fig-sig-example"></div><div id="rfc.figure.3"><div><pre>
2020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020
48545450205369676E61747572652041757468656E7469636174696F6E
00
0101010101010101010101010101010101010101010101010101010101010101
</pre></div></div><p class="figure">Figure 3: Example Content Covered by Signature</p><div id="rfc.section.3.3.p.4"><p>The purpose of this static prefix is to mitigate issues that could arise if authentication asymmetric keys were accidentally reused across protocols (even though this is forbidden, see <a href="#security" title="Security Considerations">Section 8</a>). This construction mirrors that of the TLS 1.3 CertificateVerify message defined in <a href="https://www.rfc-editor.org/rfc/rfc8446.html#section-4.4.3">Section 4.4.3</a> of <a href="#RFC8446"><cite title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>.</p></div><div id="rfc.section.3.3.p.5"><p>The resulting signature is then transmitted to the server using the <span class="tt">p</span> Parameter (see <a href="#parameter-p" title="The p Parameter">Section 4.3</a>).</p></div></section></section><hr class="hidden-print"><section id="auth-params"><h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#auth-params">Authentication Parameters</a></h2><div id="rfc.section.4.p.1"><p>This specification defines the following authentication parameters.</p></div><div id="rfc.section.4.p.2"><p>All of the byte sequences below are encoded using base64url (see <a href="https://www.rfc-editor.org/rfc/rfc4648.html#section-5">Section 5</a> of <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[BASE64]</cite></a>) without quotes and without padding. In other words, the values of these byte-sequence authentication parameters <em class="bcp14">MUST NOT</em> include any characters other than ASCII letters, digits, dash, and underscore.</p></div><div id="rfc.section.4.p.3"><p>The integer below is encoded without a minus and without leading zeroes. In other words, the value of this integer authentication parameter <em class="bcp14">MUST NOT</em> include any characters other than digits and <em class="bcp14">MUST NOT</em> start with a zero unless the full value is "0".</p></div><div id="rfc.section.4.p.4" class="avoidbreakafter"><p>Using the syntax from <a href="#RFC5234"><cite title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</cite></a>:</p></div><div id="fig-param"></div><div id="rfc.figure.4"><div><pre class="inline">
concealed-byte-sequence-param-value = *( ALPHA / DIGIT / "-" / "_" )
concealed-integer-param-value =  %x31-39 1*4( DIGIT ) / "0"
</pre></div></div><p class="figure">Figure 4: Authentication Parameter Value ABNF</p><section id="parameter-k"><h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a>&nbsp;<a href="#parameter-k">The k Parameter</a></h3><div id="rfc.section.4.1.p.1"><p>The <em class="bcp14">REQUIRED</em> "k" (key ID) Parameter is a byte sequence that identifies which key the client wishes to use to authenticate. This is used by the backend to point to an entry in a server-side database of known keys (see <a href="#backend" title="Backend Handling">Section 6.3</a>).</p></div></section><section id="parameter-a"><h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a>&nbsp;<a href="#parameter-a">The a Parameter</a></h3><div id="rfc.section.4.2.p.1"><p>The <em class="bcp14">REQUIRED</em> "a" (public key) Parameter is a byte sequence that specifies the public key used by the server to validate the signature provided by the client. This avoids key confusion issues (see <a href="#SEEMS-LEGIT"><cite title="Seems Legit: Automated Analysis of Subtle Attacks on Protocols That Use Signatures">[SEEMS-LEGIT]</cite></a>). The encoding of the public key is described in <a href="#public-key-encoding" title="Public Key Encoding">Section 3.1.1</a>.</p></div></section><section id="parameter-p"><h3 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a>&nbsp;<a href="#parameter-p">The p Parameter</a></h3><div id="rfc.section.4.3.p.1"><p>The <em class="bcp14">REQUIRED</em> "p" (proof) Parameter is a byte sequence that specifies the proof that the client provides to attest to possessing the credential that matches its key ID.</p></div></section><section id="parameter-s"><h3 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a>&nbsp;<a href="#parameter-s">The s Parameter</a></h3><div id="rfc.section.4.4.p.1"><p>The <em class="bcp14">REQUIRED</em> "s" (signature scheme) Parameter is an integer that specifies the signature scheme used to compute the proof transmitted in the <span class="tt">p</span> Parameter. Its value is an integer between 0 and 65535 inclusive from the IANA "TLS SignatureScheme" registry maintained at &lt;<a href="https://www.iana.org/assignments/tls-parameters">https://www.iana.org/assignments/tls-parameters</a>&gt;.</p></div></section><section id="parameter-v"><h3 id="rfc.section.4.5"><a href="#rfc.section.4.5">4.5.</a>&nbsp;<a href="#parameter-v">The v Parameter</a></h3><div id="rfc.section.4.5.p.1"><p>The <em class="bcp14">REQUIRED</em> "v" (verification) Parameter is a byte sequence that specifies the verification that the client provides to attest to possessing the key exporter output (see <a href="#output" title="Key Exporter Output">Section 3.2</a> for details). This avoids issues with signature schemes where certain keys can generate signatures that are valid for multiple inputs (see <a href="#SEEMS-LEGIT"><cite title="Seems Legit: Automated Analysis of Subtle Attacks on Protocols That Use Signatures">[SEEMS-LEGIT]</cite></a>).</p></div></section></section><hr class="hidden-print"><section id="example"><h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a href="#example">Example</a></h2><div id="rfc.section.5.p.1" class="avoidbreakafter"><p>For example, a client using the key ID "basement" and the signature algorithm Ed25519 <a href="#RFC8410"><cite title="Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure">[ED25519]</cite></a> could produce the following header field:</p></div><div id="fig-hdr-example"></div><div id="rfc.figure.5"><div><pre class="text">
NOTE: '\' line wrapping per RFC 8792

Authorization: Concealed \
  k=YmFzZW1lbnQ, \
  a=VGhpcyBpcyBh-HB1YmxpYyBrZXkgaW4gdXNl_GhlcmU, \
  s=2055, \
  v=dmVyaWZpY2F0aW9u_zE2Qg, \
  p=QzpcV2luZG93c_xTeXN0ZW0zMlxkcml2ZXJz-ENyb3dkU\
    3RyaWtlXEMtMDAwMDAwMDAyOTEtMD-wMC0w_DAwLnN5cw
</pre></div></div><p class="figure">Figure 5: Example Header Field</p></section><hr class="hidden-print"><section id="server-handling"><h2 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a>&nbsp;<a href="#server-handling">Server Handling</a></h2><div id="rfc.section.6.p.1" class="avoidbreakafter"><p>In this section, we subdivide the server role in two:</p></div><div id="rfc.section.6.p.2"><ul><li><div><p>The "frontend" runs in the HTTP server that terminates the TLS or QUIC connection created by the client.</p></div> </li><li><div><p>The "backend" runs in the HTTP server that has access to the database of accepted key identifiers and public keys.</p></div> </li></ul></div><div id="rfc.section.6.p.3"><p>In most deployments, we expect both the frontend and backend roles to be implemented in a single HTTP origin server (as defined in <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-3.6">Section 3.6</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>). However, these roles can be split such that the frontend is an HTTP gateway (as defined in <a href="https://www.rfc-editor.org/rfc/rfc9110.html#section-3.7">Section 3.7</a> of <a href="#RFC9110"><cite title="HTTP Semantics">[HTTP]</cite></a>) and the backend is an HTTP origin server.</p></div><section id="frontend-handling"><h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a>&nbsp;<a href="#frontend-handling">Frontend Handling</a></h3><div id="rfc.section.6.1.p.1"><p>If a frontend is configured to check the Concealed HTTP authentication scheme, it will parse the Authorization (or Proxy-Authorization) header field. If the authentication scheme is set to "Concealed", the frontend <em class="bcp14">MUST</em> validate that all the required authentication parameters are present and can be parsed correctly as defined in <a href="#auth-params" title="Authentication Parameters">Section 4</a>. If any parameter is missing or fails to parse, the frontend <em class="bcp14">MUST</em> ignore the entire Authorization (or Proxy-Authorization) header field.</p></div><div id="rfc.section.6.1.p.2"><p>The frontend then uses the data from these authentication parameters to compute the key exporter output, as defined in <a href="#output" title="Key Exporter Output">Section 3.2</a>. The frontend then shares the header field and the key exporter output with the backend.</p></div></section><section id="communication-between-frontend-and-backend"><h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a>&nbsp;<a href="#communication-between-frontend-and-backend">Communication Between Frontend and Backend</a></h3><div id="rfc.section.6.2.p.1"><p>If the frontend and backend roles are implemented in the same machine, this can be handled by a simple function call.</p></div><div id="rfc.section.6.2.p.2" class="avoidbreakafter"><p>If the roles are split between two separate HTTP servers, then the backend won't be able to directly access the TLS keying material exporter from the TLS connection between the client and frontend, so the frontend needs to explicitly send it. This document defines the "Concealed-Auth-Export" request header field for this purpose. The Concealed-Auth-Export header field's value is a Structured Field Byte Sequence (see <a href="https://www.rfc-editor.org/rfc/rfc9651.html#section-3.3.5">Section 3.3.5</a> of <a href="#RFC9651"><cite title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</cite></a>) that contains the 48-byte key exporter output (see <a href="#output" title="Key Exporter Output">Section 3.2</a>), without any parameters. Note that Structured Field Byte Sequences are encoded using the non-URL-safe variant of base64. For example:</p></div><div id="fig-int-hdr-example"></div><div id="rfc.figure.6"><div><pre class="text">
NOTE: '\' line wrapping per RFC 8792

Concealed-Auth-Export: :VGhpc+BleGFtcGxlIFRMU/BleHBvcn\
  Rlc+BvdXRwdXQ/aXMgNDggYnl0ZXMgI/+h:
</pre></div></div><p class="figure">Figure 6: Example Concealed-Auth-Export Header Field</p><div id="rfc.section.6.2.p.3"><p>The frontend <em class="bcp14">SHALL</em> forward the HTTP request to the backend, including the original unmodified Authorization (or Proxy-Authorization) header field and the newly added Concealed-Auth-Export header field.</p></div><div id="rfc.section.6.2.p.4"><p>Note that, since the security of this mechanism requires the key exporter output to be correct, backends need to trust frontends to send it truthfully. This trust relationship is common because the frontend already needs access to the TLS certificate private key in order to respond to requests. HTTP servers that parse the Concealed-Auth-Export header field <em class="bcp14">MUST</em> ignore it unless they have already established that they trust the sender. Similarly, frontends that send the Concealed-Auth-Export header field <em class="bcp14">MUST</em> ensure that they do not forward any Concealed-Auth-Export header field received from the client.</p></div></section><section id="backend"><h3 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a>&nbsp;<a href="#backend">Backend Handling</a></h3><div id="rfc.section.6.3.p.1" class="avoidbreakafter"><p>Once the backend receives the Authorization (or Proxy-Authorization) header field and the key exporter output, it looks up the key ID in its database of public keys. The backend <em class="bcp14">SHALL</em> then perform the following checks:</p></div><div id="rfc.section.6.3.p.2"><ul><li><div><p>validate that all the required authentication parameters are present and can be parsed correctly as defined in <a href="#auth-params" title="Authentication Parameters">Section 4</a></p></div> </li><li><div><p>ensure the key ID is present in the backend's database and maps to a corresponding public key</p></div> </li><li><div><p>validate that the public key from the database is equal to the one in the Authorization (or Proxy-Authorization) header field</p></div> </li><li><div><p>validate that the verification field from the Authorization (or Proxy-Authorization) header field matches the one extracted from the key exporter output</p></div> </li><li><div><p>verify the cryptographic signature as defined in <a href="#computation" title="Signature Computation">Section 3.3</a></p></div> </li></ul></div><div id="rfc.section.6.3.p.3"><p>If all of these checks succeed, the backend can consider the request to be properly authenticated and can reply accordingly (the backend can also forward the request to another HTTP server).</p></div><div id="rfc.section.6.3.p.4"><p>If any of the above checks fail, the backend <em class="bcp14">MUST</em> treat it as if the Authorization (or Proxy-Authorization) header field was missing.</p></div></section><section id="non-probeable-server-handling"><h3 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a>&nbsp;<a href="#non-probeable-server-handling">Non-Probeable Server Handling</a></h3><div id="rfc.section.6.4.p.1"><p>Servers that wish to introduce resources whose existence cannot be probed need to ensure that they do not reveal any information about those resources to unauthenticated clients. In particular, such servers <em class="bcp14">MUST</em> respond to authentication failures with the exact same response that they would have used for nonexistent resources. For example, this can mean using HTTP status code 404 (Not Found) instead of 401 (Unauthorized).</p></div><div id="rfc.section.6.4.p.2"><p>The authentication checks described above can take time to compute, and an attacker could detect use of this mechanism if that time is observable by comparing the timing of a request for a known nonexistent resource to the timing of a request for a potentially authenticated resource. Servers can mitigate this observability by slightly delaying responses to some nonexistent resources such that the timing of the authentication verification is not observable. This delay needs to be carefully considered to avoid having the delay itself leak the fact that this origin uses this mechanism at all.</p></div><div id="rfc.section.6.4.p.3"><p>Non-probeable resources also need to be non-discoverable for unauthenticated users. For example, if a server operator wishes to hide an authenticated resource by pretending it does not exist to unauthenticated users, then the server operator needs to ensure there are no unauthenticated pages with links to that resource and no other out-of-band ways for unauthenticated users to discover this resource.</p></div></section></section><hr class="hidden-print"><section id="requirements-on-tls-usage"><h2 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a>&nbsp;<a href="#requirements-on-tls-usage">Requirements on TLS Usage</a></h2><div id="rfc.section.7.p.1"><p>This authentication scheme is only defined for uses of HTTP with TLS <a href="#RFC8446"><cite title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>. This includes any use of HTTP over TLS as typically used for HTTP/2 <a href="#RFC9113"><cite title="HTTP/2">[HTTP/2]</cite></a>, or HTTP/3 <a href="#RFC9114"><cite title="HTTP/3">[HTTP/3]</cite></a> where the transport protocol uses TLS as its authentication and key exchange mechanism <a href="#RFC9001"><cite title="Using TLS to Secure QUIC">[QUIC-TLS]</cite></a>.</p></div><div id="rfc.section.7.p.2" class="avoidbreakafter"><p>Because the TLS keying material exporter is only secure for authentication when it is uniquely bound to the TLS session <a href="#RFC7627"><cite title="Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension">[RFC7627]</cite></a>, the Concealed authentication scheme requires either one of the following properties:</p></div><div id="rfc.section.7.p.3"><ul><li><div><p>The TLS version in use is greater than or equal to 1.3 <a href="#RFC8446"><cite title="The Transport Layer Security (TLS) Protocol Version 1.3">[TLS]</cite></a>.</p></div> </li><li><div><p>The TLS version in use is 1.2, and the extended master secret extension <a href="#RFC7627"><cite title="Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension">[RFC7627]</cite></a> has been negotiated.</p></div> </li></ul></div><div id="rfc.section.7.p.4"><p>Clients <em class="bcp14">MUST NOT</em> use the Concealed HTTP authentication scheme on connections that do not meet one of the two properties above. If a server receives a request that uses this authentication scheme on a connection that meets neither of the above properties, the server <em class="bcp14">MUST</em> treat the request as if the authentication were not present.</p></div></section><hr class="hidden-print"><section id="security"><h2 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a>&nbsp;<a href="#security">Security Considerations</a></h2><div id="rfc.section.8.p.1"><p>The Concealed HTTP authentication scheme allows a client to authenticate to an origin server while guaranteeing freshness and without the need for the server to transmit a nonce to the client. This allows the server to accept authenticated clients without revealing that it supports or expects authentication for some resources. It also allows authentication without the client leaking the presence of authentication to observers due to cleartext TLS Client Hello extensions.</p></div><div id="rfc.section.8.p.2"><p>Since the freshness described above is provided by a TLS key exporter, it can be as old as the underlying TLS connection. Servers can require better freshness by forcing clients to create new connections using mechanisms such as the GOAWAY frame (see <a href="https://www.rfc-editor.org/rfc/rfc9114.html#section-5.2">Section 5.2</a> of <a href="#RFC9114"><cite title="HTTP/3">[HTTP/3]</cite></a>).</p></div><div id="rfc.section.8.p.3"><p>The authentication proofs described in this document are not bound to individual HTTP requests; if the key is used for authentication proofs on multiple requests on the same connection, they will all be identical. This allows for better compression when sending over the wire, but it implies that client implementations that multiplex different security contexts over a single HTTP connection need to ensure that those contexts cannot read each other's header fields. Otherwise, one context would be able to replay the Authorization header field of another. This constraint is met by modern web browsers. If an attacker were to compromise the browser such that it could access another context's memory, the attacker might also be able to access the corresponding key, so binding authentication to requests would not provide much benefit in practice.</p></div><div id="rfc.section.8.p.4"><p>Authentication asymmetric keys used for the Concealed HTTP authentication scheme <em class="bcp14">MUST NOT</em> be reused in other protocols. Even though we attempt to mitigate these issues by adding a static prefix to the signed data (see <a href="#computation" title="Signature Computation">Section 3.3</a>), reusing keys could undermine the security guarantees of the authentication.</p></div><div id="rfc.section.8.p.5"><p>Origins offering this scheme can link requests that use the same key. However, requests are not linkable across origins if the keys used are specific to the individual origins using this scheme.</p></div></section><hr class="hidden-print"><section id="iana"><h2 id="rfc.section.9" class="np"><a href="#rfc.section.9">9.</a>&nbsp;<a href="#iana">IANA Considerations</a></h2><section id="iana-schemes"><h3 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a>&nbsp;<a href="#iana-schemes">HTTP Authentication Schemes Registry</a></h3><div id="rfc.section.9.1.p.1" class="avoidbreakafter"><p>IANA has registered the following entry in the "HTTP Authentication Schemes" registry maintained at &lt;<a href="https://www.iana.org/assignments/http-authschemes">https://www.iana.org/assignments/http-authschemes</a>&gt;:</p></div><div id="rfc.section.9.1.p.2"><dl class="compact"><dt>Authentication Scheme Name:</dt><dd style="margin-left: 1.5em">Concealed</dd><dt>Reference:</dt><dd style="margin-left: 1.5em">RFC 9729</dd><dt>Notes:</dt><dd style="margin-left: 1.5em">None</dd></dl></div></section><section id="iana-exporter-label"><h3 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a>&nbsp;<a href="#iana-exporter-label">TLS Keying Material Exporter Labels</a></h3><div id="rfc.section.9.2.p.1" class="avoidbreakafter"><p>IANA has registered the following entry in the "TLS Exporter Labels" registry maintained at &lt;<a href="https://www.iana.org/assignments/tls-parameters">https://www.iana.org/assignments/tls-parameters</a>&gt;:</p></div><div id="rfc.section.9.2.p.2"><dl class="compact"><dt>Value:</dt><dd style="margin-left: 1.5em">EXPORTER-HTTP-Concealed-Authentication</dd><dt>DTLS-OK:</dt><dd style="margin-left: 1.5em">N</dd><dt>Recommended:</dt><dd style="margin-left: 1.5em">Y</dd><dt>Reference:</dt><dd style="margin-left: 1.5em">RFC 9729</dd></dl></div></section><section id="http-field-name"><h3 id="rfc.section.9.3"><a href="#rfc.section.9.3">9.3.</a>&nbsp;<a href="#http-field-name">HTTP Field Name</a></h3><div id="rfc.section.9.3.p.1" class="avoidbreakafter"><p>IANA has registered the following entry in the "Hypertext Transfer Protocol (HTTP) Field Name Registry" maintained at &lt;<a href="https://www.iana.org/assignments/http-fields">https://www.iana.org/assignments/http-fields</a>&gt;:</p></div><div id="rfc.section.9.3.p.2"><dl class="compact"><dt>Field Name:</dt><dd style="margin-left: 1.5em">Concealed-Auth-Export</dd><dt>Status:</dt><dd style="margin-left: 1.5em">permanent</dd><dt>Structured Type:</dt><dd style="margin-left: 1.5em">Item</dd><dt>Reference:</dt><dd style="margin-left: 1.5em">RFC 9729</dd><dt>Comments:</dt><dd style="margin-left: 1.5em">None</dd></dl></div></section></section><section id="sec-combined-references" class="np"><div id="rfc.references"><h2 id="rfc.section.10"><a href="#rfc.section.10">10.</a> References</h2><section id="sec-normative-references"><div id="rfc.references.2"><h3 id="rfc.section.10.1"><a href="#rfc.section.10.1">10.1.</a> Normative References</h3><dl class="dl-horizontal"><dt id="RFC5234">[<a href="#RFC5234" class="smpl">ABNF</a>]</dt><dd>Crocker, D., Ed. and P. Overell, â€œ<a href="https://www.rfc-editor.org/rfc/rfc5234.html">Augmented BNF for Syntax Specifications: ABNF</a>â€, <a href="https://www.rfc-editor.org/info/std68">STD 68</a>, RFC 5234, <a href="https://dx.doi.org/10.17487/RFC5234">DOI 10.17487/RFC5234</a>, January 2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.</dd><dt id="RFC4648">[<a href="#RFC4648" class="smpl">BASE64</a>]</dt><dd>Josefsson, S., â€œ<a href="https://www.rfc-editor.org/rfc/rfc4648.html">The Base16, Base32, and Base64 Data Encodings</a>â€, RFC 4648, <a href="https://dx.doi.org/10.17487/RFC4648">DOI 10.17487/RFC4648</a>, October 2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;.</dd><dt id="RFC8032">[<a href="#RFC8032" class="smpl">EdDSA</a>]</dt><dd>Josefsson, S. and I. Liusvaara, â€œ<a href="https://www.rfc-editor.org/rfc/rfc8032.html">Edwards-Curve Digital Signature Algorithm (EdDSA)</a>â€, RFC 8032, <a href="https://dx.doi.org/10.17487/RFC8032">DOI 10.17487/RFC8032</a>, January 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;.</dd><dt id="RFC9110">[<a href="#RFC9110" class="smpl">HTTP</a>]</dt><dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., â€œ<a href="https://www.rfc-editor.org/rfc/rfc9110.html">HTTP Semantics</a>â€, <a href="https://www.rfc-editor.org/info/std97">STD 97</a>, RFC 9110, <a href="https://dx.doi.org/10.17487/RFC9110">DOI 10.17487/RFC9110</a>, June 2022, &lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;.</dd><dt id="RFC5705">[<a href="#RFC5705" class="smpl">KEY-EXPORT</a>]</dt><dd>Rescorla, E., â€œ<a href="https://www.rfc-editor.org/rfc/rfc5705.html">Keying Material Exporters for Transport Layer Security (TLS)</a>â€, RFC 5705, <a href="https://dx.doi.org/10.17487/RFC5705">DOI 10.17487/RFC5705</a>, March 2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;.</dd><dt id="RFC8017">[<a href="#RFC8017" class="smpl">PKCS1</a>]</dt><dd>Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A. Rusch, â€œ<a href="https://www.rfc-editor.org/rfc/rfc8017.html">PKCS #1: RSA Cryptography Specifications Version 2.2</a>â€, RFC 8017, <a href="https://dx.doi.org/10.17487/RFC8017">DOI 10.17487/RFC8017</a>, November 2016, &lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;.</dd><dt id="RFC9000">[<a href="#RFC9000" class="smpl">QUIC</a>]</dt><dd>Iyengar, J., Ed. and M. Thomson, Ed., â€œ<a href="https://www.rfc-editor.org/rfc/rfc9000.html">QUIC: A UDP-Based Multiplexed and Secure Transport</a>â€, RFC 9000, <a href="https://dx.doi.org/10.17487/RFC9000">DOI 10.17487/RFC9000</a>, May 2021, &lt;<a href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;.</dd><dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt><dd>Bradner, S., â€œ<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words for use in RFCs to Indicate Requirement Levels</a>â€, <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997, &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC7627">[<a href="#RFC7627" class="smpl">RFC7627</a>]</dt><dd>Bhargavan, K., Ed., Delignat-Lavaud, A., Pironti, A., Langley, A., and M. Ray, â€œ<a href="https://www.rfc-editor.org/rfc/rfc7627.html">Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension</a>â€, RFC 7627, <a href="https://dx.doi.org/10.17487/RFC7627">DOI 10.17487/RFC7627</a>, September 2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7627">https://www.rfc-editor.org/info/rfc7627</a>&gt;.</dd><dt id="RFC8174">[<a href="#RFC8174" class="smpl">RFC8174</a>]</dt><dd>Leiba, B., â€œ<a href="https://www.rfc-editor.org/rfc/rfc8174.html">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>â€, <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 8174, <a href="https://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.</dd><dt id="RFC8792">[<a href="#RFC8792" class="smpl">RFC8792</a>]</dt><dd>Watsen, K., Auerswald, E., Farrel, A., and Q. Wu, â€œ<a href="https://www.rfc-editor.org/rfc/rfc8792.html">Handling Long Lines in Content of Internet-Drafts and RFCs</a>â€, RFC 8792, <a href="https://dx.doi.org/10.17487/RFC8792">DOI 10.17487/RFC8792</a>, June 2020, &lt;<a href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;.</dd><dt id="RFC9651">[<a href="#RFC9651" class="smpl">STRUCTURED-FIELDS</a>]</dt><dd>Nottingham, M. and P-H. Kamp, â€œ<a href="https://www.rfc-editor.org/rfc/rfc9651.html">Structured Field Values for HTTP</a>â€, RFC 9651, <a href="https://dx.doi.org/10.17487/RFC9651">DOI 10.17487/RFC9651</a>, September 2024, &lt;<a href="https://www.rfc-editor.org/info/rfc9651">https://www.rfc-editor.org/info/rfc9651</a>&gt;.</dd><dt id="RFC8446">[<a href="#RFC8446" class="smpl">TLS</a>]</dt><dd>Rescorla, E., â€œ<a href="https://www.rfc-editor.org/rfc/rfc8446.html">The Transport Layer Security (TLS) Protocol Version 1.3</a>â€, RFC 8446, <a href="https://dx.doi.org/10.17487/RFC8446">DOI 10.17487/RFC8446</a>, August 2018, &lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.</dd><dt id="RFC3986">[<a href="#RFC3986" class="smpl">URI</a>]</dt><dd>Berners-Lee, T., Fielding, R., and L. Masinter, â€œ<a href="https://www.rfc-editor.org/rfc/rfc3986.html">Uniform Resource Identifier (URI): Generic Syntax</a>â€, <a href="https://www.rfc-editor.org/info/std66">STD 66</a>, RFC 3986, <a href="https://dx.doi.org/10.17487/RFC3986">DOI 10.17487/RFC3986</a>, January 2005, &lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;.</dd><dt id="X.690">[<a href="#X.690" class="smpl">X.690</a>]</dt><dd>ITU-T, â€œ<a href="https://www.itu.int/rec/T-REC-X.690">Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</a>â€, ITU-T Recommendation X690, ISO/IEC 8825-1:2021, February 2021, &lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;.</dd></dl></div></section><section id="sec-informative-references"><div id="rfc.references.3"><h3 id="rfc.section.10.2"><a href="#rfc.section.10.2">10.2.</a> Informative References</h3><dl class="dl-horizontal"><dt id="RFC8410">[<a href="#RFC8410" class="smpl">ED25519</a>]</dt><dd>Josefsson, S. and J. Schaad, â€œ<a href="https://www.rfc-editor.org/rfc/rfc8410.html">Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure</a>â€, RFC 8410, <a href="https://dx.doi.org/10.17487/RFC8410">DOI 10.17487/RFC8410</a>, August 2018, &lt;<a href="https://www.rfc-editor.org/info/rfc8410">https://www.rfc-editor.org/info/rfc8410</a>&gt;.</dd><dt id="RFC7486">[<a href="#RFC7486" class="smpl">HOBA</a>]</dt><dd>Farrell, S., Hoffman, P., and M. Thomas, â€œ<a href="https://www.rfc-editor.org/rfc/rfc7486.html">HTTP Origin-Bound Authentication (HOBA)</a>â€, RFC 7486, <a href="https://dx.doi.org/10.17487/RFC7486">DOI 10.17487/RFC7486</a>, March 2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7486">https://www.rfc-editor.org/info/rfc7486</a>&gt;.</dd><dt id="RFC9113">[<a href="#RFC9113" class="smpl">HTTP/2</a>]</dt><dd>Thomson, M., Ed. and C. Benfield, Ed., â€œ<a href="https://www.rfc-editor.org/rfc/rfc9113.html">HTTP/2</a>â€, RFC 9113, <a href="https://dx.doi.org/10.17487/RFC9113">DOI 10.17487/RFC9113</a>, June 2022, &lt;<a href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;.</dd><dt id="RFC9114">[<a href="#RFC9114" class="smpl">HTTP/3</a>]</dt><dd>Bishop, M., Ed., â€œ<a href="https://www.rfc-editor.org/rfc/rfc9114.html">HTTP/3</a>â€, RFC 9114, <a href="https://dx.doi.org/10.17487/RFC9114">DOI 10.17487/RFC9114</a>, June 2022, &lt;<a href="https://www.rfc-editor.org/info/rfc9114">https://www.rfc-editor.org/info/rfc9114</a>&gt;.</dd><dt id="I-D.schinazi-masque">[<a href="#I-D.schinazi-masque" class="smpl">MASQUE-ORIGINAL</a>]</dt><dd>Schinazi, D., â€œ<a href="https://datatracker.ietf.org/doc/html/draft-schinazi-masque-00">The MASQUE Protocol</a>â€, <a href="https://datatracker.ietf.org/doc/draft-schinazi-masque">Work in Progress</a>, draft-schinazi-masque-00, Work in Progress, February 2019, &lt;<a href="https://datatracker.ietf.org/doc/html/draft-schinazi-masque-00">https://datatracker.ietf.org/doc/html/draft-schinazi-masque-00</a>&gt;.</dd><dt id="RFC9001">[<a href="#RFC9001" class="smpl">QUIC-TLS</a>]</dt><dd>Thomson, M., Ed. and S. Turner, Ed., â€œ<a href="https://www.rfc-editor.org/rfc/rfc9001.html">Using TLS to Secure QUIC</a>â€, RFC 9001, <a href="https://dx.doi.org/10.17487/RFC9001">DOI 10.17487/RFC9001</a>, May 2021, &lt;<a href="https://www.rfc-editor.org/info/rfc9001">https://www.rfc-editor.org/info/rfc9001</a>&gt;.</dd><dt id="SEEMS-LEGIT">[<a href="#SEEMS-LEGIT" class="smpl">SEEMS-LEGIT</a>]</dt><dd>Jackson, D., Cremers, C., Cohn-Gordon, K., and R. Sasse, â€œ<a href="https://doi.org/10.1145/3319535.3339813">Seems Legit: Automated Analysis of Subtle Attacks on Protocols That Use Signatures</a>â€, <a href="https://dx.doi.org/10.1145/3319535.3339813">DOI 10.1145/3319535.3339813</a>, CCS '19: Proceedings of the 2019 ACM SIGSAC Conference on Computer and Communications Security, pp. 2165-2180, November 2019, &lt;<a href="https://doi.org/10.1145/3319535.3339813">https://doi.org/10.1145/3319535.3339813</a>&gt;.</dd></dl></div></section></div></section><hr class="hidden-print"><section id="acknowledgments"><h2 id="rfc.section.unnumbered-4" class="np"><a href="#acknowledgments">Acknowledgments</a></h2><div id="rfc.section.unnumbered-4.p.1"><p>The authors would like to thank many members of the IETF community, as this document is the fruit of many hallway conversations. In particular, the authors would like to thank David Benjamin, Reese Enghardt, Nick Harper, Dennis Jackson, Ilari Liusvaara, FranÃ§ois Michel, Lucas Pardue, Justin Richer, Ben Schwartz, Martin Thomson, and Chris A. Wood for their reviews and contributions. The mechanism described in this document was originally part of the first iteration of MASQUE <a href="#I-D.schinazi-masque"><cite title="The MASQUE Protocol">[MASQUE-ORIGINAL]</cite></a>.</p></div></section><hr class="hidden-print"><section id="rfc.authors" class="np"><h2><a href="#rfc.authors">Authors' Addresses</a></h2><address><b>David Schinazi</b><br>Google LLC<br>1600 Amphitheatre Parkway<br>Mountain View, CA 94043<br>United States of America<br>EMail: <a href="mailto:dschinazi.ietf@gmail.com">dschinazi.ietf@gmail.com</a></address><address><b>David M. Oliver</b><br>Guardian Project<br>EMail: <a href="mailto:david@guardianproject.info">david@guardianproject.info</a><br>URI: <a href="https://guardianproject.info">https://guardianproject.info</a></address><address><b>Jonathan Hoyland</b><br>Cloudflare Inc.<br>EMail: <a href="mailto:jonathan.hoyland@gmail.com">jonathan.hoyland@gmail.com</a></address></section></div></div></div><script src="/assets/node_modules/jquery/dist/jquery.min.js"></script><script src="/assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script></body></html>